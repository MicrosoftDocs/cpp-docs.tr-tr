---
title: CRowset Sınıfı
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 689cd3a1f7496ad75bf83e0b1a2a14f7bd1b1f6f
ms.sourcegitcommit: 63784729604aaf526de21f6c6b62813882af930a
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/17/2020
ms.locfileid: "79441178"
---
# <a name="crowset-class"></a>CRowset Sınıfı

OLE DB satır kümesi nesnesini ve bazı ilgili arabirimleri kapsüller ve satır kümesi verileri için işleme yöntemleri sağlar.

## <a name="syntax"></a>Sözdizimi

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parametreler

*TAccessor*<br/>
Erişimci sınıfı. Varsayılan değer: `CAccessorBase`.

## <a name="requirements"></a>Gereksinimler

**Üstbilgi:** atldbclı. h

## <a name="members"></a>Üyeler

### <a name="methods"></a>Yöntemler

|||
|-|-|
|[AddRefRows](#addrefrows)|Geçerli satırla ilişkili başvuru sayısını artırır.|
|[~Eksik](#close)|Satırları ve geçerli `IRowset` arabirimini yayınlar.|
|[Compare](#compare)|[IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85))kullanarak iki yer işaretini karşılaştırır.|
|[CRowset](#crowset)|Yeni bir `CRowset` nesnesi oluşturur ve (isteğe bağlı olarak) onu bir parametre olarak sağlanan bir `IRowset` arabirimiyle ilişkilendirir.|
|[Silme](#delete)|[IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85))kullanarak satır kümesinden satır siler.|
|[FindNextRow](#findnextrow)|Belirtilen yer işaretinden sonra sonraki eşleşen satırı bulur.|
|[GetApproximatePosition](#getapproximateposition)|Bir yer işaretine karşılık gelen satırın yaklaşık konumunu döndürür.|
|[GetData](#getdata)|Satır kümesinin satır kopyasından verileri alır.|
|[GetDataHere](#getdatahere)|Belirtilen arabellekteki verileri alır.|
|[GetOriginalData](#getoriginaldata)|Bekleyen değişiklikleri yoksayarak veri kaynağından en son getirilen veya aktarılan verileri alır.|
|[GetRowStatus](#getrowstatus)|Tüm satırların durumunu döndürür.|
|[Ekleyin](#insert)|[IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85))kullanarak yeni bir satır oluşturur ve ekler.|
|[IsSameRow](#issamerow)|Belirtilen satırı geçerli satırla karşılaştırır.|
|[MoveFirst](#movefirst)|Sonraki getirme konumunu ilk konuma konumlandırır.|
|[MoveLast](#movelast)|Son kayda gider.|
|[Iken](#movenext)|Sonraki sıralı satırdan veya bir sonraki satırın ötesinde belirtilen sayıda konumda veri getirir.|
|[MovePrev](#moveprev)|Önceki kayda gider.|
|[MoveToBookmark](#movetobookmark)|Bir yer işareti tarafından işaretlenen satırı veya bu yer işaretinin belirtilen uzaklığında satırı getirir.|
|[MoveToRatio](#movetoratio)|Satır kümesindeki kesirli konumdan başlayarak satırları getirir.|
|[ReleaseRows](#releaserows)|Geçerli satır tanıtıcısını serbest bırakmak için [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) çağırır.|
|[SetData](#setdata)|Bir satırın bir veya daha fazla sütununda [IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85))kullanarak veri değerlerini ayarlar.|
|[Komutunu](#undo)|Son getirme veya [güncelleştirmeden](../../data/oledb/crowset-update.md)bu yana bir satırda yapılan tüm değişiklikleri geri alır.|
|[Güncelleştirme](#update)|Son getirme veya güncelleştirmeden bu yana geçerli satıra yapılan bekleyen değişiklikleri iletir.|
|[UpdateAll](#updateall)|Son getirme veya güncelleştirmeden bu yana tüm satırlarda yapılan bekleyen değişiklikleri iletir.|

## <a name="remarks"></a>Açıklamalar

OLE DB, bir satır kümesi, bir programın verileri ayarladığı ve aldığı nesnedir.

Bu sınıf, örneklenemez, ancak `CTable` veya `CCommand` bir şablon parametresi olarak geçirilir (`CRowset` varsayılandır).

## <a name="addrefrows"></a>CRowset:: AddRefRows

Geçerli satır tutamacı ile ilişkili başvuru sayısını artırmak için [IRowset:: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) çağırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, geçerli satır tanıtıcısının başvuru sayısını artırır. Sayıyı azaltmak için [ReleaseRows](../../data/oledb/crowset-releaserows.md) çağırın. Taşıma yöntemlerinin döndürdüğü satırların başvuru sayısı bir olmalıdır.

## <a name="close"></a>CRowset:: Close

Satırları ve geçerli [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) arabirimini yayınlar.

### <a name="syntax"></a>Sözdizimi

```cpp
void Close() throw();
```

### <a name="remarks"></a>Açıklamalar

Bu yöntem, şu anda satır kümesindeki tüm satırları serbest bırakır.

## <a name="compare"></a>CRowset:: Compare

[IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85))kullanarak iki yer işaretini karşılaştırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parametreler

*Bookmark1*<br/>
'ndaki Karşılaştırılacak ilk yer işareti.

*Bookmark2*<br/>
'ndaki Karşılaştırılacak ikinci yer işareti.

*pComparison*<br/>
dışı Karşılaştırma sonucuna yönelik bir işaretçi.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetLocate`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetLocate` ayarlamanız gerekir.

Tüketicilerle yer işaretlerini kullanma hakkında daha fazla bilgi için bkz. [yer Imlerini kullanma](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a>CRowset:: CRowset

Yeni bir `CRowset` nesnesi oluşturur ve (isteğe bağlı) onu bir parametre olarak sağlanan bir [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) arabirimiyle ilişkilendirir.

### <a name="syntax"></a>Sözdizimi

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parametreler

*pRowset*<br/>
'ndaki Bu sınıfla ilişkilendirilecek `IRowset` arabirimine yönelik bir işaretçi.

## <a name="delete"></a>CRowset::D Sil

Kayıt kümesinden geçerli satırı silmek için [IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) çağırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

## <a name="findnextrow"></a>CRowset:: FindNextRow

Belirtilen yer işaretinden sonra sonraki eşleşen satırı bulur.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parametreler

*üs*<br/>
'ndaki Satır değerlerini karşılaştırmak için kullanılacak işlem. Değerler için bkz. [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
'ndaki Eşleştirilecek değere yönelik bir işaretçi.

*wType*<br/>
'ndaki Arabelleğin değer bölümünün veri türünü gösterir. Tür göstergeleri hakkında daha fazla bilgi için, Windows SDK *OLE DB Programcı başvurusu* Içindeki [veri türleri](/previous-versions/windows/desktop/ms723969(v=vs.85)) bölümüne bakın.

*nLength*<br/>
'ndaki Veri değeri için ayrılan tüketici veri yapısının bayt cinsinden uzunluğu. Ayrıntılar için, *OLE DB Programcı başvurusu* Içindeki [dbbinding yapılarında](/previous-versions/windows/desktop/ms716845(v=vs.85)) `cbMaxLen` açıklamasına bakın.

*bPrecision*<br/>
'ndaki Veri alınırken kullanılan duyarlık üst sınırı. Yalnızca *wType* DBTYPE_NUMERIC ise kullanılır. Daha fazla bilgi için bkz. *OLE DB Programcı başvurusunda* [DBTYPE_NUMERIC veya DBTYPE_DECIMAL içeren dönüştürmeler](/previous-versions/windows/desktop/ms719714(v=vs.85)) .

*bScale*<br/>
'ndaki Veri alınırken kullanılan ölçek. Yalnızca *wType* DBTYPE_NUMERIC veya DBTYPE_DECIMAL ise kullanılır. Daha fazla bilgi için bkz. *OLE DB Programcı başvurusunda* [DBTYPE_NUMERIC veya DBTYPE_DECIMAL içeren dönüştürmeler](/previous-versions/windows/desktop/ms719714(v=vs.85)) .

*bSkipCurrent*<br/>
'ndaki Yer işaretinden, aramanın başlatılacağı satır sayısı.

*pBookmark*<br/>
'ndaki Aramanın başlatılacağı konum için yer işareti.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetFind`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetFind` ayarlamanız gerekir.

Tüketicilerle yer işaretlerini kullanma hakkında daha fazla bilgi için bkz. [yer Imlerini kullanma](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a>CRowset:: GetApproximatePosition

Bir yer işaretine karşılık gelen satırın yaklaşık konumunu döndürür.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parametreler

*pBookmark*<br/>
'ndaki Konumu bulunan satırı tanımlayan yer işaretine yönelik bir işaretçi. Yalnızca satır sayısı gerekliyse NULL.

*pPosition*<br/>
dışı `GetApproximatePosition` satırın konumunu döndüren konuma yönelik bir işaretçi. Konum gerekmiyorsa NULL.

*pcRows*<br/>
dışı `GetApproximatePosition` toplam satır sayısını döndüren konuma yönelik bir işaretçi. Satır sayısı gerekmiyorsa NULL.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetScroll`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetScroll` ayarlamanız gerekir.

Tüketicilerle yer işaretlerini kullanma hakkında daha fazla bilgi için bkz. [yer Imlerini kullanma](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a>CRowset:: GetData

Satır kümesinin satır kopyasından verileri alır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parametreler

*nAccessor*<br/>
'ndaki Verilere erişmek için kullanılacak erişimcinin (sıfır-fark) dizin numarası.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

[BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md)içinde bir oto erişimcisi olmayan bir erişimci belirtirseniz, erişimci numarasını geçirerek verileri açıkça almak için bu yöntemi kullanın.

## <a name="getdatahere"></a>CRowset:: GetDataHere

Geçerli satırdan verileri alır ve belirtilen arabelleğe koyar.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parametreler

*nAccessor*<br/>
'ndaki Verilere erişmek için kullanılacak erişimcinin Dizin numarası.

*pBuffer*<br/>
dışı Geçerli kayıt için verilerin yerleştirileceği bir arabellek.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu işlevi nasıl kullanacağınızı gösteren bir örnek için bkz. [MultiRead örneği](../../overview/visual-cpp-samples.md).

## <a name="getoriginaldata"></a>CRowset:: GetOriginalData

Veri kaynağından en son getirilen veya aktarılan verileri almak için `IRowsetUpdate::GetOriginalData` çağırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, en son getirilen veya veri kaynağından aktarılan verileri alır; bekleyen değişikliklere göre değerleri almaz.

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetUpdate`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetUpdate` ayarlamanız gerekir.

## <a name="getrowstatus"></a>CRowset:: GetRowStatus

Tüm satırların durumunu döndürür.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parametreler

*pStatus*<br/>
dışı `GetRowStatus` durum değerini döndüren konuma yönelik bir işaretçi. OLE DB Programcı başvurusunda DBPENDINGSTATUS bölümüne bakın.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetUpdate`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetUpdate` ayarlamanız gerekir.

## <a name="insert"></a>CRowset:: INSERT

Erişimcinin verilerini kullanarak yeni bir satır oluşturur ve başlatır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parametreler

*nAccessor*<br/>
'ndaki Verileri eklemek için kullanılacak erişimcinin numarası.

*bGetHRow*<br/>
'ndaki Yerleştirilen satır için tanıtıcının alınıp alınmayacağını belirtir.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetChange`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetChange` ayarlamanız gerekir.

Bir veya daha fazla sütun yazılabilir değilse INSERT başarısız olabilir. Bunu düzeltmek için imleç eşlemenizi değiştirin.

### <a name="example"></a>Örnek

Aşağıdaki örnek, bir veri kaynağına bir satır kümesi aracılığıyla nasıl eriş, sonra o satır kümesindeki bir tabloyu kullanarak bir dize nasıl ekleneceğini gösterir.

İlk olarak, projenize yeni bir ATL nesnesi ekleyerek tablo sınıfı oluşturun. Örneğin, çalışma alanı bölmesinde projeye sağ tıklayın ve **yenı ATL nesnesi**' ni seçin. **Veri erişimi** kategorisinden **Tüketici**' yi seçin. **Tablo**türünde bir tüketici nesnesi oluşturun. ( **Tablo** seçme doğrudan tablodan bir satır kümesi oluşturur; **komut** seçme seçeneği bir SQL komutu aracılığıyla bir satır kümesi oluşturur.) Bu veri kaynağına erişmek için bir tablo belirterek bir veri kaynağı seçin. Tüketici nesneniz **Ccustomertable**' ı çağırırsanız, ekleme kodunuzu aşağıdaki şekilde uygulamalısınız:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a>CRowset:: IsSameRow

Belirtilen satırı geçerli satırla karşılaştırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parametreler

*hRow*<br/>
'ndaki Geçerli satırla Karşılaştırılacak satıra yönelik bir tanıtıcı.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT. S_OK satırların aynı olduğunu gösterir. Diğer değerler için, Windows SDK *OLE DB Programcı başvurusunda* bkz. [IRowsetIndentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) .

## <a name="movefirst"></a>CRowset:: MoveFirst

İmleci ilk konuma taşıın ve ilk satırı alır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Sonraki getirme konumunu ilk konum olarak yeniden konumlandırmak için [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) çağırır (satır kümesi oluşturulduğunda bir sonraki getirme konumu olan konum) ve ilk satırı alır.

## <a name="movelast"></a>CRowset:: MoveLast

İmleci son satıra kaydırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Sonraki getirme konumunu son konuma yeniden konumlandırmak için [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) çağırır ve son satırı alır.

Bu yöntem, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE `DBPROP_CANSCROLLBACKWARDS` ayarlamanızı gerektirir. (Daha iyi performans için `DBPROP_QUICKRESTART` VARIANT_TRUE olarak da ayarlayabilirsiniz.)

## <a name="movenext"></a>CRowset:: MoveNext

İmleci bir sonraki kayda kaydırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parametreler

*lSkip*<br/>
'ndaki Getirmeden önce atlanacak satır sayısı.

*Bilet*<br/>
'ndaki Sonraki kayda ilerlemek için **doğru** geçirin, geriye doğru ilerlemek için **false** .

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT. Satır kümesinin sonuna ulaşıldığında DB_S_ENDOFROWSET döndürür.

### <a name="remarks"></a>Açıklamalar

`CRowset` nesnesinden sonraki sıralı satırı getirir ve önceki konumu hatırlar. İsteğe bağlı olarak, bir sonraki *lSkip* satırı atlamayı veya geriye doğru taşımayı seçebilirsiniz.

Bu yöntem, satır kümesini içeren tablo veya komutta `Open` çağrılmadan önce aşağıdaki özellikleri ayarlamanızı gerektirir:

- *lSkip* < 0 ise `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE olmalıdır

- *bForward* = false ise `DBPROP_CANFETCHBACKWARDS` VARIANT_TRUE olmalıdır

Aksi takdirde ( *lSkip* > = 0 ve *bForward* = true), ek özellikler ayarlamanız gerekmez.

## <a name="moveprev"></a>CRowset:: Moveöncekini

İmleci önceki kayda kaydırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, satır kümesini içeren tablodaki veya komutta `Open` çağrılmadan önce `DBPROP_CANFETCHBACKWARDS` veya `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE olarak ayarlamanızı gerektirir.

## <a name="movetobookmark"></a>CRowset:: MoveToBookmark

Yer işaretiyle işaretlenmiş satırı veya belirtilen bir uzaklığında (*lSkip*) satırı bu yer işaretinden getirir.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parametreler

*Yer işareti*<br/>
'ndaki Veri getirmek istediğiniz konuma işaret eden bir yer işareti.

*lSkip*<br/>
'ndaki Yer işaretinden hedef satıra ait satır sayısı. *LSkip* sıfır ise, ilk alınan satır yer işareti yer işaretiyle kaydedilir. *LSkip* 1 ise, getirilen ilk satır, yer işareti alınan satırdan sonraki satırdır. *LSkip* -1 ise, getirilen ilk satır, yer işareti alınan satırdan önceki satırdır.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetLocate`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE `DBPROP_IRowsetLocate` ayarlamanız ve `DBPROP_CANFETCHBACKWARDS` VARIANT_TRUE ayarlamanız gerekir.

Tüketicilerle yer işaretlerini kullanma hakkında daha fazla bilgi için bkz. [yer Imlerini kullanma](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a>CRowset:: MoveToRatio

Satır kümesindeki kesirli konumdan başlayarak satırları getirir.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parametreler

*Npay*<br/>
'ndaki Verilerin getirileceği kesirli konumsal değeri belirlemede kullanılan pay.

*Npayda*<br/>
'ndaki Verilerin alınacağı kesirli konumsal değeri belirlemede kullanılan payda.

*Bilet*<br/>
'ndaki İleri veya geri hareket edilip edilmeyeceğini gösterir. Varsayılan değer ileri ' dir.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

`MoveToRatio`, satırları kabaca aşağıdaki formüle göre getirir:

`(nNumerator *  RowsetSize ) / nDenominator`

Burada `RowsetSize`, satır içinde ölçülen satır kümesinin boyutudur. Bu formülün doğruluğu, belirli sağlayıcıya bağlıdır. Ayrıntılar için bkz. [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetScroll`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetScroll` ayarlamanız gerekir.

## <a name="releaserows"></a>CRowset:: ReleaseRows

Geçerli satır tanıtıcısını serbest bırakmak için [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) çağırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

## <a name="setdata"></a>CRowset:: SetData

Bir satırın bir veya daha fazla sütununda veri değerlerini ayarlar.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parametreler

*nAccessor*<br/>
'ndaki Verilere erişmek için kullanılacak erişimcinin sayısı.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bağımsız değişken içermeyen `SetData` form için, tüm erişimciler güncelleştirme için kullanılır. Genellikle bir satırdaki sütunlarda veri değerlerini ayarlamak için `SetData` çağırır, ardından bu değişiklikleri aktarmak için [Update](../../data/oledb/crowset-update.md) 'i çağırın.

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetChange`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetChange` ayarlamanız gerekir.

Bir veya daha fazla sütun yazılabilir değilse ayar işlemi başarısız olabilir. Bunu düzeltmek için imleç eşlemenizi değiştirin.

## <a name="undo"></a>CRowset:: Undo

Son getirme veya [güncelleştirmeden](../../data/oledb/crowset-update.md)bu yana bir satırda yapılan tüm değişiklikleri geri alır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametreler

*pcRows*<br/>
dışı `Undo`, gerektiğinde geri almaya çalıştığı satır sayısını döndüren konuma yönelik bir işaretçi.

*phRow*<br/>
dışı `Undo`, gerektiğinde geri almaya çalıştığı tüm satırlara bir dizi tutamacı döndüren konuma yönelik bir işaretçi.

*pStatus*<br/>
dışı `Undo` satır durumu değerini döndüren konuma yönelik bir işaretçi. *PStatus* null ise hiçbir durum döndürülmez.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetUpdate`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetUpdate` ayarlamanız gerekir.

## <a name="update"></a>CRowset:: Update

Son getirme veya `Update` çağrısından bu yana geçerli satıra yapılan bekleyen değişiklikleri iletir.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametreler

*pcRows*<br/>
dışı `Update`, güncelleştirmeye çalıştığı satır sayısını (gerekliyse) geri döndürdüğü konuma yönelik bir işaretçi.

*phRow*<br/>
dışı `Update`, güncelleştirmeye çalıştığı satırın tanıtıcısını döndüren konuma yönelik bir işaretçi. *Phrow* null ise hiçbir tanıtıcı döndürülmez.

*pStatus*<br/>
dışı `Update` satır durumu değerini döndüren konuma yönelik bir işaretçi. *PStatus* null ise hiçbir durum döndürülmez.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

### <a name="remarks"></a>Açıklamalar

Geçerli satıra yapılan bekleyen değişiklikleri, bu satırın en son getirilme veya güncelleştirildiği bu yana iletir (`Update` veya [UpdateAll](../../data/oledb/crowset-updateall.md)kullanılarak). Tipik olarak, bir satırdaki sütunlarda veri değerlerini ayarlamak için [SetData](../../data/oledb/crowset-setdata.md) 'yı çağırın ve ardından bu değişiklikleri iletmek için `Update` çağırın.

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetUpdate`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetUpdate` ayarlamanız gerekir.

## <a name="updateall"></a>CRowset:: UpdateAll

Son getirme veya `Update` çağrısından bu yana tüm satırlarda yapılan bekleyen değişiklikleri iletir.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametreler

*pcRows*<br/>
dışı `UpdateAll`, güncelleştirmeye çalıştığı satır sayısını (gerekliyse) geri döndürdüğü konuma yönelik bir işaretçi.

*pphRow*<br/>
dışı `UpdateAll` güncelleştirmeye çalıştığı satırın tanıtıcısını döndürdüğü belleğe yönelik bir işaretçi. *PphRow* null ise hiçbir tanıtıcı döndürülmez.

*ppStatus*<br/>
dışı `Update` satır durumu değerini döndüren konuma yönelik bir işaretçi. *PpStatus* null olduğunda hiçbir durum döndürülmez.

### <a name="remarks"></a>Açıklamalar

Tüm satırlarda yapılan bekleyen değişiklikleri, bu satırlar son getirilen veya [güncelleştirme](../../data/oledb/crowset-update.md) veya `UpdateAll`ile güncelleştirildiği için iletir. `UpdateAll`, hala ( *pphRow*) için tanıtıcı olup olmadığından bağımsız olarak değiştirilen her satırı güncelleştirecektir.

Örneğin, bir satır kümesine beş satır eklemek için `Insert` kullandıysanız, beş kez `Update` çağırabilir veya tümünü güncelleştirmek için bir kez `UpdateAll` çağırabilirsiniz.

Bu yöntem, tüm sağlayıcılar üzerinde desteklenmeyebilir `IRowsetUpdate`isteğe bağlı arabirimi gerektirir; Bu durumda, yöntem E_NOINTERFACE döndürür. Ayrıca, satır kümesini içeren tabloda veya komutta `Open` çağrılmadan önce VARIANT_TRUE olarak `DBPROP_IRowsetUpdate` ayarlamanız gerekir.

### <a name="return-value"></a>Dönüş Değeri

Standart HRESULT.

## <a name="see-also"></a>Ayrıca bkz.

[DBViewer örneği](../../overview/visual-cpp-samples.md)<br/>
[MultiRead örneği](../../overview/visual-cpp-samples.md)<br/>
[MultiRead öznitelikleri örneği](../../overview/visual-cpp-samples.md)<br/>
[OLE DB tüketici şablonları](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[OLE DB Tüketici Şablonları Başvurusu](../../data/oledb/ole-db-consumer-templates-reference.md)