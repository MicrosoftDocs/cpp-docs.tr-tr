---
title: CRowset Sınıfı
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: dc4f619fb0dba924693682c927247e809fe2cfe9
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59032332"
---
# <a name="crowset-class"></a>CRowset Sınıfı

Bir OLE DB satır kümesi nesnesi ve ilgili birkaç kapsayan arabirimleri ve satır kümesi veri işleme yöntemlerini sağlar.

## <a name="syntax"></a>Sözdizimi

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parametreler

*TAccessor*<br/>
Bir erişimci sınıfı. Varsayılan, `CAccessorBase` değeridir.

## <a name="requirements"></a>Gereksinimler

**Başlık:** atldbcli.h

## <a name="members"></a>Üyeler

### <a name="methods"></a>Yöntemler

|||
|-|-|
|[AddRefRows](#addrefrows)|Artışlarla başvuru sayısı geçerli satır ile ilişkili.|
|[Kapat](#close)|Satırları ve geçerli sürümleri `IRowset` arabirimi.|
|[Compare](#compare)|Karşılaştırır iki yer işaretlerini kullanarak [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Yeni bir oluşturur `CRowset` nesne ve bunu ile ilişkilendirir (isteğe bağlı olarak) bir `IRowset` bir parametre olarak sağlanan arabirim.|
|[Delete](#delete)|Satır kümesi kullanarak satırları siler [IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Belirtilen yer işaretinden sonra sonraki eşleşen satırı bulur.|
|[GetApproximatePosition](#getapproximateposition)|Yaklaşık bir yer işaretine karşılık gelen bir satır konumunu döndürür.|
|[GetData](#getdata)|Satır satır kümesinin kopyadan verileri alır.|
|[GetDataHere](#getdatahere)|Belirtilen arabellek verilerini alır.|
|[GetOriginalData](#getoriginaldata)|En son öğesinden alınan veya bekleyen değişiklikleri yoksayma veri kaynağına gönderilen verileri alır.|
|[GetRowStatus](#getrowstatus)|Tüm satırları durumunu döndürür.|
|[Ekle](#insert)|Oluşturur ve kullanarak yeni bir satır ekler [IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[Issamerow](#issamerow)|Geçerli satır belirtilen satırı karşılaştırır.|
|[MoveFirst](#movefirst)|Sonraki getirme konumunu ilk konumuna yeniden konumlandırır.|
|[MoveLast](#movelast)|Son kayda gider.|
|[MoveNext](#movenext)|Bir sonraki sıralı satır ya da bir belirli sayıdaki uzaklığına sonraki satırda ötesinde veri getirir.|
|[MovePrev](#moveprev)|Önceki kayda gider.|
|[MoveToBookmark](#movetobookmark)|Bu yer işaretinden yer işareti tarafından işaretlenen satırı veya belirtilen bir uzaklık satırı getirir.|
|[MoveToRatio](#movetoratio)|Satır kümesindeki kesirli bir konumdan başlayan satırları getirir.|
|[ReleaseRows](#releaserows)|Çağrıları [IRowset::ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) geçerli satır tanıtıcısını bırakmak için.|
|[SetData](#setdata)|Kullanarak bir satır bir veya daha fazla sütun veri değerlerini ayarlar [IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Geri alma](#undo)|Satır son getirme bu yana yapılan değişiklikleri geri alır veya [güncelleştirme](../../data/oledb/crowset-update.md).|
|[Güncelleştir](#update)|Bekleyen tüm geçerli satırın son getirme veya güncelleştirme yapılan değişiklikleri iletir.|
|[UpdateAll](#updateall)|Bekleyen tüm son getirme veya güncelleştirme tüm satırları için yapılan değişiklikleri iletir.|

## <a name="remarks"></a>Açıklamalar

OLE DB'de bir satır kümesi, bir program ayarlar ve verileri alır nesnedir.

Bu sınıf örneği ancak bunun yerine bir şablon parametre olarak geçirilen tasarlanmamıştır `CTable` veya `CCommand` (`CRowset` varsayılandır).

## <a name="addrefrows"></a> CRowset::AddRefRows

Çağrıları [IRowset::AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) (bir) başvuru sayısını artırmak için geçerli satır tanıtıcısı ile ilişkili.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, geçerli satır tanıtıcısı için başvuru sayısını artırır. Çağrı [ReleaseRows](../../data/oledb/crowset-releaserows.md) sayısını azaltmak için. Taşıma yöntemleri tarafından döndürülen satır bir başvuru sayısına sahip.

## <a name="close"></a> CRowset::Close

Satırları ve geçerli sürümleri [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) arabirimi.

### <a name="syntax"></a>Sözdizimi

```cpp
void Close() throw();
```

### <a name="remarks"></a>Açıklamalar

Bu yöntem, şu anda satır kümesindeki tüm satırları serbest bırakır.

## <a name="compare"></a> CRowset::Compare

Karşılaştırır iki yer işaretlerini kullanarak [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parametreler

*Bookmark1*<br/>
[in] Karşılaştırılacak ilk yer işareti.

*Bookmark2*<br/>
[in] Karşılaştırılacak ikinci yer işareti.

*pComparison*<br/>
[out] Karşılaştırmanın sonucu için bir işaretçi.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetLocate`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetLocate` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

Tüketicilerinizin yer işaretlerini kullanma hakkında daha fazla bilgi için bkz: [kullanarak yer işaretleri](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a> CRowset::CRowset

Yeni bir oluşturur `CRowset` nesne ve bunu ile ilişkilendirir (isteğe bağlı olarak) bir [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) bir parametre olarak sağlanan arabirim.

### <a name="syntax"></a>Sözdizimi

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parametreler

*pRowset*<br/>
[in] Bir işaretçi bir `IRowset` arabirimi bu sınıf ile ilişkili olması.

## <a name="delete"></a> CRowset::Delete

Çağrıları [IRowsetChange::DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)) geçerli satır satır kümesinden silinemedi.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

## <a name="findnextrow"></a> CRowset::FindNextRow

Belirtilen yer işaretinden sonra sonraki eşleşen satırı bulur.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parametreler

*OP*<br/>
[in] Satır değerleri karşılaştırmak kullanılacak işlem. Değerler için bkz: [IRowsetFind::FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
[in] Eşleştirilecek değer için bir işaretçi.

*wType*<br/>
[in] Arabellek değer bölümünü veri türünü belirtir. Türü göstergeleri hakkında daha fazla bilgi için bkz. [veri türleri](/previous-versions/windows/desktop/ms723969(v=vs.85)) içinde *OLE DB Programcının Başvurusu* Windows SDK.

*nLength*<br/>
[in] Uzunluğu, bayt cinsinden veri değeri için ayrılmış tüketici veri yapısı. Açıklamasını Ayrıntılar için bkz `cbMaxLen` içinde [IAccessor::CreateAccessor'ı yapıları](/previous-versions/windows/desktop/ms716845(v=vs.85)) içinde *OLE DB Programcının Başvurusu.*

*bPrecision*<br/>
[in] Veri alınırken kullanılan en yüksek duyarlık. Yalnızca şu durumlarda kullanılan *wType* DBTYPE_NUMERIC olduğu. Daha fazla bilgi için [DBTYPE_NUMERIC veya DBTYPE_DECIMAL içeren dönüştürmeler](/previous-versions/windows/desktop/ms719714(v=vs.85)) içinde *OLE DB Programcının Başvurusu*.

*bScale*<br/>
[in] Veri alınırken kullanılan ölçek. Yalnızca şu durumlarda kullanılan *wType* DBTYPE_NUMERIC veya DBTYPE_DECIMAL. Daha fazla bilgi için [DBTYPE_NUMERIC veya DBTYPE_DECIMAL içeren dönüştürmeler](/previous-versions/windows/desktop/ms719714(v=vs.85)) içinde *OLE DB Programcının Başvurusu*.

*bSkipCurrent*<br/>
[in] Yer işareti bir arama başlayacağı satır sayısı.

*pBookmark*<br/>
[in] Yer işareti için bir arama başlayacağı konum.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetFind`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetFind` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

Tüketicilerinizin yer işaretlerini kullanma hakkında daha fazla bilgi için bkz: [kullanarak yer işaretleri](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition

Yaklaşık bir yer işaretine karşılık gelen bir satır konumunu döndürür.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parametreler

*pBookmark*<br/>
[in] Bulunacak konumu olan satırı tanımlayan bir yer işareti için bir işaretçi. Yalnızca satır sayısı gerekliyse null değerini DÖNDÜRÜR.

*pPosition*<br/>
[out] Konumu için bir işaretçi burada `GetApproximatePosition` satır konumunu döndürür. Konum gerekli değilse null değerini DÖNDÜRÜR.

*pcRows*<br/>
[out] Konumu için bir işaretçi burada `GetApproximatePosition` toplam satır sayısını döndürür. Satır sayısı gerekli değilse null değerini DÖNDÜRÜR.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetScroll`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetScroll` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

Tüketicilerinizin yer işaretlerini kullanma hakkında daha fazla bilgi için bkz: [kullanarak yer işaretleri](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a> CRowset::GetData

Satır satır kümesinin kopyadan verileri alır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parametreler

*nAccessor*<br/>
[in] Verilere erişmek için kullanılacak bir erişimci (sıfır sapma) dizin sayısı.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Erişimcinin içinde değil bir erişimci belirtirseniz [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), açıkça erişimci sayısını geçirerek verileri almak için bu yöntemi kullanın.

## <a name="getdatahere"></a> CRowset::GetDataHere

Geçerli satırdaki verileri alır ve belirtilen arabelleğine koyar.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parametreler

*nAccessor*<br/>
[in] Erişimci, verilere erişmek için kullanılacak dizini sayısı.

*pBuffer*<br/>
[out] Bir arabelleğe geçerli kayıt verilerini yerleştirmek için.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu işlevi kullanmak nasıl bir örnek için bkz [MultiRead örnek](../../overview/visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset::GetOriginalData

Çağrıları `IRowsetUpdate::GetOriginalData` dan getirilen veya veri kaynağına gönderilen en son verileri almak üzere.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem en son öğesinden alınan veya veri kaynağına gönderilen verileri alır; Bekleyen değişiklikler temel değerleri almaz.

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetUpdate`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetUpdate` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

## <a name="getrowstatus"></a> CRowset::GetRowStatus

Tüm satırları durumunu döndürür.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parametreler

*pStatus*<br/>
[out] Bir işaretçi bir konuma burada `GetRowStatus` durum değeri döndürür. OLE DB Programcının Başvurusu DBPENDINGSTATUS bakın.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetUpdate`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetUpdate` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

## <a name="insert"></a> CRowset::INSERT

Oluşturur ve veri erişimci kullanarak yeni bir satır başlatır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parametreler

*nAccessor*<br/>
[in] Veri eklemek için kullanılan erişimci sayısı.

*bGetHRow*<br/>
[in] Eklenen satırın tanıtıcı alınan olup olmadığını gösterir.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetChange`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetChange` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

Bir veya daha fazla sütun ise yazılabilir ekleme başarısız olabilir. Bu sorunu gidermek için imleç harita değiştirin.

### <a name="example"></a>Örnek

Aşağıdaki örnek, bir satır kümesi bir veri kaynağına erişmek ve ardından söz konusu satır kümesinde bir tablo kullanarak bir dize eklemek gösterilmektedir.

İlk olarak projenize yeni bir ATL nesne ekleyerek bir tablo sınıfı oluşturun. Örneğin, çalışma alanı bölmesinde projeyi sağ tıklayıp **yeni ATL nesnesi**. Gelen **veri erişimi** kategorisi, select **tüketici**. Bir tüketici türü nesne oluşturma **tablo**. (Seçerek **tablo** doğrudan tablodan bir satır oluşturur; seçme **komut** SQL komutu aracılığıyla bir satır kümesi oluşturur.) Belirten bir tablo, bu veri kaynağına erişmek bir veri kaynağını seçin. Tüketici nesnenizin çağırırsanız **CCustomerTable**, ardından ekleme kodunuz şu şekilde uygulayabilir:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> CRowset::ıssamerow

Geçerli satır belirtilen satırı karşılaştırır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parametreler

*hRow*<br/>
[in] Geçerli satırın karşılaştırmak için bir satır için bir tanıtıcı.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT. Satırları aynıdır S_OK gösterir. Diğer değerler için bkz. [IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) içinde *OLE DB Programcının Başvurusu* Windows SDK.

## <a name="movefirst"></a> CRowset::MoveFirst

İmleç ilk konuma taşır ve ilk satır alır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Çağrıları [IRowset::RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) sonraki getirme konumunu ilk konumuna (satır kümesi oluşturduğunuzda, sonraki getirme konumunu konumu) yeniden konumlandırmak için ve ilk satır alır.

## <a name="movelast"></a> CRowset::MoveLast

İmleç son satıra taşır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Çağrıları [IRowset::RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) sonraki getirme konumunu son yeniden konumlandırmak için getirin ve son satırını alır.

Bu yöntem, ayarladığınız gerektirir `DBPROP_CANSCROLLBACKWARDS` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu. (Daha iyi performans için de ayarlayabilirsiniz `DBPROP_QUICKRESTART` VARIANT_TRUE için.)

## <a name="movenext"></a> CRowset::MoveNext

İmleci sonraki kayda taşır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parametreler

*lSkip*<br/>
[in] Getirilmeden önce atlanacak satır sayısı.

*bForward*<br/>
[in] Geçirmek **true** sonraki kayda ilerlemek için **false** geriye doğru gitme.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT. Satır sonuna ulaşıldığında DB_S_ENDOFROWSET döndürür.

### <a name="remarks"></a>Açıklamalar

Bir sonraki sıralı satırdan getirir `CRowset` önceki konumdan hatırlamak nesnesi. İsteğe bağlı olarak, önceden atlamayı seçebilirsiniz *lSkip* satır veya geriye doğru taşıyın.

Bu yöntemi çağırmadan önce aşağıdaki özellikleri ayarlayın gerektirir `Open` tablo ya da komut satır kümesi içeren:

- `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE olmalıdır *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` VARIANT_TRUE olmalıdır *bForward* = false

Aksi takdirde (varsa *lSkip* > = 0 ve *bForward* = true), ek özellikleri ayarlamak gerekmez.

## <a name="moveprev"></a> CRowset::MovePrev

İmleci önceki kayda taşır.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem ya da ayarlamanızı gerektirir `DBPROP_CANFETCHBACKWARDS` veya `DBPROP_CANSCROLLBACKWARDS` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

## <a name="movetobookmark"></a> CRowset::MoveToBookmark

Bir yer işareti veya belirtilen bir uzaklık satırında tarafından işaretlenen satırı getirir (*lSkip*), yer işareti öğesinden.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parametreler

*Yer işareti*<br/>
[in] Veri getirmek istediğiniz yeri işaretlemek bir yer işareti.

*lSkip*<br/>
[in] Yer işareti hedef satır satır numarası sayısı. Varsa *lSkip* sıfırsa, getirilen ilk satır işaretli bir satırdır. Varsa *lSkip* 1, getirilen ilk satırın sonuna işaretli satır satırdır. Varsa *lSkip* -1, ilk satırın getirilen işaretli satır önce satırdır.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetLocate`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. De ayarlamanız gerekir `DBPROP_IRowsetLocate` VARIANT_TRUE ve kümesi `DBPROP_CANFETCHBACKWARDS` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

Tüketicilerinizin yer işaretlerini kullanma hakkında daha fazla bilgi için bkz: [kullanarak yer işaretleri](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a> CRowset::MoveToRatio

Satır kümesindeki kesirli bir konumdan başlayan satırları getirir.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parametreler

*nNumerator*<br/>
[in] Kesirli belirlemek için kullanılan pay, verileri getirmek konumsal.

*nDenominator*<br/>
[in] Kesirli belirlemek için kullanılan paydası konumsal verileri getirmek üzere.

*bForward*<br/>
[in] İleriye veya geriye doğru gitme görüntülenip görüntülenmeyeceğini gösterir. İleri varsayılandır.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

`MoveToRatio` kabaca şu formüle göre satırları getirir:

`(nNumerator *  RowsetSize ) / nDenominator`

Burada `RowsetSize` satırlarda ölçülen satır boyutu. Bu formül doğruluğunu belirli sağlayıcısına bağlıdır. Ayrıntılar için bkz [IRowsetScroll::GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetScroll`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetScroll` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

## <a name="releaserows"></a> CRowset::ReleaseRows

Çağrıları [IRowset::ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) geçerli satır tanıtıcısını bırakmak için.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

## <a name="setdata"></a> CRowset::SetData

Bir satırın bir veya daha fazla sütun veri değerlerini ayarlar.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parametreler

*nAccessor*<br/>
[in] Verilere erişmek için kullanılacak erişimci sayısı.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

İçin `SetData` kabul eden herhangi bir bağımsız değişken, tüm erişimcileri form güncelleştirmek için kullanılır. Genellikle arama `SetData` bir satırdaki sütun veri değerlerini ayarlamak için ardından çağırın [güncelleştirme](../../data/oledb/crowset-update.md) bu değişiklikleri aktarmak için.

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetChange`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetChange` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

Bir veya daha fazla sütun ise yazılabilir ayarlama işlemi başarısız olabilir. Bu sorunu gidermek için imleç harita değiştirin.

## <a name="undo"></a> CRowset::Undo

Satır son getirme bu yana yapılan değişiklikleri geri alır veya [güncelleştirme](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametreler

*pcRows*<br/>
[out] Konumu için bir işaretçi burada `Undo` çalıştı gerekirse geri satır sayısını döndürür.

*phRow*<br/>
[out] Konumu için bir işaretçi burada `Undo` çalıştı gerekirse geri almak için tüm satırların tanıtıcıları dizisini döndürür.

*pStatus*<br/>
[out] Konumu için bir işaretçi burada `Undo` satır durum değeri döndürür. Durum yok döndürülür *pStatus* null.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetUpdate`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetUpdate` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

## <a name="update"></a> CRowset::Update

Bekleyen tüm geçerli satırın son getirme bu yana yapılan değişiklikleri iletir veya `Update` çağrı.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametreler

*pcRows*<br/>
[out] Konumu için bir işaretçi burada `Update` , denenen güncelleştirmek için gerekirse satır sayısını döndürür.

*phRow*<br/>
[out] Konumu için bir işaretçi burada `Update` çalıştı güncelleştirilecek satırın tanıtıcısını döndürür. Hiçbir tanıtıcı döndürülür *phRow* null.

*pStatus*<br/>
[out] Konumu için bir işaretçi burada `Update` satır durum değeri döndürür. Durum yok döndürülür *pStatus* null.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

### <a name="remarks"></a>Açıklamalar

Bekleyen tüm geçerli satıra o satırın son getirilen veya güncelleştirilmiş itibaren yapılan değişiklikleri iletir (kullanarak `Update` veya [UpdateAll](../../data/oledb/crowset-updateall.md)). Genellikle arama [SetData](../../data/oledb/crowset-setdata.md) satırda sütun veri değerlerini ayarlayın ve ardından çağırmak için `Update` bu değişiklikleri aktarmak için.

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetUpdate`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetUpdate` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

## <a name="updateall"></a> CRowset::UpdateAll

Bekleyen tüm son getirme itibaren tüm satırları için yapılan değişiklikleri iletir veya `Update` çağrı.

### <a name="syntax"></a>Sözdizimi

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametreler

*pcRows*<br/>
[out] Konumu için bir işaretçi burada `UpdateAll` , denenen güncelleştirmek için gerekirse satır sayısını döndürür.

*pphRow*<br/>
[out] Burada bellek işaretçisi `UpdateAll` çalıştı güncelleştirilecek satırın tanıtıcısını döndürür. Hiçbir tanıtıcı döndürülür *pphRow* null.

*ppStatus*<br/>
[out] Konumu için bir işaretçi burada `Update` satır durum değeri döndürür. Durum yok döndürülür *ppStatus* null.

### <a name="remarks"></a>Açıklamalar

Bekleyen tüm satırları son getirildi kullanılarak veya güncelleştirildiğinde bu yana tüm satırları için yapılan değişiklikleri iletir [güncelleştirme](../../data/oledb/crowset-update.md) veya `UpdateAll`. `UpdateAll` hala tanıtıcı kendileri için olmasına bakılmaksızın değiştirilmiş her satır güncelleştirir (bkz *pphRow*) veya değil.

Örneğin, kullandıysanız `Insert` bir satır kümesinde beş satır eklemek için çağrısı olabilir. `Update` beş kat veya çağrı `UpdateAll` tümünü güncelleştirmek için bir kez.

Bu yöntem, isteğe bağlı bir arabirim gerektirir `IRowsetUpdate`, tüm sağlayıcılarında; bu desteklenmeyebilir durumda, e_noınterface yöntemi döndürür. Ayrıca ayarlamanız gerekir `DBPROP_IRowsetUpdate` çağırmadan önce VARIANT_TRUE için `Open` tablosu veya satır kümesi içeren komutu.

### <a name="return-value"></a>Dönüş Değeri

Standart bir HRESULT.

## <a name="see-also"></a>Ayrıca bkz.

[DBVIEWER örneği](../../overview/visual-cpp-samples.md)<br/>
[MultiRead örnek](../../overview/visual-cpp-samples.md)<br/>
[Örnek multiRead öznitelikleri](../../overview/visual-cpp-samples.md)<br/>
[OLE DB Tüketici Şablonları](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[OLE DB Tüketici Şablonları Başvurusu](../../data/oledb/ole-db-consumer-templates-reference.md)